<!DOCTYPE html><pre class="language-julia"><code>if !isdir(&quot;pluto-deployment-environment&quot;) || length(ARGS) != 1
    error(&quot;&quot;&quot;
    Run me from the root of the repository directory, using:

    julia tools/update_notebook_packages.jl &lt;level>
    
    Where &lt;level> is one of: PATCH, MINOR, MAJOR
    &quot;&quot;&quot;)
end

if VERSION &lt; v&quot;1.6.0-aaa&quot;
    @error &quot;Our website needs to be generated with Julia 1.6. Go to julialang.org/downloads to install it.&quot;
end

import Pkg
Pkg.activate(&quot;./pluto-deployment-environment&quot;)
Pkg.instantiate()

import Pluto

flatmap(args...) = vcat(map(args...)...)


all_files_recursive = flatmap(walkdir(&quot;src&quot;)) do (root, _dirs, files)
    joinpath.((root,), files)
end

all_notebooks = filter(Pluto.is_pluto_notebook, all_files_recursive)

level = getfield(Pkg, Symbol(&quot;UPLEVEL_$(ARGS[1])&quot;))

for n in all_notebooks
    @info &quot;Updating&quot; n
    Pluto.update_notebook_environment(n; backup=false, level)
end
</code></pre>
